<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Headquartz.Pages.WarehousePage"
             x:Name="PageRoot"
             Title="WarehousePage">

    <ScrollView>
        <VerticalStackLayout Padding="{StaticResource LayoutPadding}" Spacing="0">

            <!-- Page Header -->
            <HorizontalStackLayout Spacing="0" Margin="0,0,0,8">
                <VerticalStackLayout >
                    <Label Text="Warehouse" Style="{StaticResource PageTitle}" />
                    <Label Text="Manage your product stock levels" Style="{StaticResource PageSubtitle}" />
                </VerticalStackLayout>
                <Button Text="+ Add Product" Style="{StaticResource PrimaryButton}" VerticalOptions="Center" />
            </HorizontalStackLayout>

            <!-- Summary Cards -->
            <Grid ColumnDefinitions="*,*,*" ColumnSpacing="16" Margin="0,0,0,24">

                <Border Grid.Column="0" Style="{StaticResource StatCard}">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Total Items" Style="{StaticResource CardTitle}" />
                        <Label Text="{Binding TotalItems}" Style="{StaticResource StatValue}" />
                        <Label Text="Across all products" Style="{StaticResource StatChange}" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                    </VerticalStackLayout>
                </Border>

                <Border Grid.Column="1" Style="{StaticResource StatCard}">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Low Stock Items" Style="{StaticResource CardTitle}" />
                        <Label Text="{Binding LowStockCount}" Style="{StaticResource StatValue}" TextColor="{StaticResource Warning}" />
                        <Label Text="Need reordering" Style="{StaticResource StatChange}" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                    </VerticalStackLayout>
                </Border>

                <Border Grid.Column="2" Style="{StaticResource StatCard}">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Total Value" Style="{StaticResource CardTitle}" />
                        <Label Text="{Binding TotalValue, StringFormat='${0:N0}'}" Style="{StaticResource StatValue}" />
                        <Label Text="Current inventory worth" Style="{StaticResource StatChange}" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                    </VerticalStackLayout>
                </Border>

            </Grid>

            <!-- Product List -->
            <Border Style="{StaticResource CardBorder}">
                <VerticalStackLayout Spacing="16">

                    <HorizontalStackLayout Spacing="16" HorizontalOptions="FillAndExpand">
                        <Label Text="Products" Style="{StaticResource Title3}" HorizontalOptions="StartAndExpand" VerticalOptions="Center" />

                        <!-- Search/Filter -->
                        <Border Background="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource DarkBackground}}" Padding="12,8" StrokeShape="RoundRectangle 8" StrokeThickness="0" WidthRequest="300">
                            <Entry Placeholder="Search products..." PlaceholderColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource SecondaryDarkText}}" TextColor="{AppThemeBinding Light={StaticResource DarkOnLightBackground}, Dark={StaticResource LightOnDarkBackground}}" BackgroundColor="Transparent" />
                        </Border>
                    </HorizontalStackLayout>

                    <!-- Product Table Header -->
                    <Grid ColumnDefinitions="2*,*,*,*,*" Padding="12,8" Background="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource DarkBackground}}" ColumnSpacing="16">
                        <Label Grid.Column="0" Text="Product Name" Style="{StaticResource Caption1Strong}" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                        <Label Grid.Column="1" Text="Stock" Style="{StaticResource Caption1Strong}" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                        <Label Grid.Column="2" Text="Status" Style="{StaticResource Caption1Strong}" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                        <Label Grid.Column="3" Text="Price" Style="{StaticResource Caption1Strong}" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                        <Label Grid.Column="4" Text="Actions" Style="{StaticResource Caption1Strong}" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                    </Grid>

                    <!-- Product Items -->
                    <CollectionView ItemsSource="{Binding Products}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="2*,*,*,*,*" Padding="12" ColumnSpacing="16" RowSpacing="8">

                                    <!-- Product Name -->
                                    <VerticalStackLayout Grid.Column="0" Spacing="4">
                                        <Label Text="{Binding Name}" FontSize="16" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource DarkOnLightBackground}, Dark={StaticResource LightOnDarkBackground}}" />
                                        <Label Text="SKU-001" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource SecondaryDarkText}}" />
                                    </VerticalStackLayout>

                                    <!-- Stock -->
                                    <Label Grid.Column="1" Text="{Binding Quantity}" FontSize="16" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource DarkOnLightBackground}, Dark={StaticResource LightOnDarkBackground}}" VerticalOptions="Center" />

                                    <!-- Status Badge -->
                                    <Border Grid.Column="2" Background="{Binding StatusColor}" Padding="8,4" StrokeShape="RoundRectangle 12" StrokeThickness="0" HorizontalOptions="Start" VerticalOptions="Center">
                                        <Label Text="{Binding StatusText}" FontSize="11" FontAttributes="Bold" TextColor="White" />
                                    </Border>

                                    <!-- Price -->
                                    <Label Grid.Column="3" Text="$25.00" FontSize="16" TextColor="{AppThemeBinding Light={StaticResource DarkOnLightBackground}, Dark={StaticResource LightOnDarkBackground}}" VerticalOptions="Center" />

                                    <!-- Actions -->
                                    <HorizontalStackLayout Grid.Column="4" Spacing="8" VerticalOptions="Center">
                                        <Button Text="ðŸ“¦" Style="{StaticResource IconButton}" Command="{Binding BindingContext.RestockCommand, Source={x:Reference PageRoot}}" CommandParameter="{Binding Name}" ToolTipProperties.Text="Restock" />
                                        <Button Text="âœï¸" Style="{StaticResource IconButton}" ToolTipProperties.Text="Edit" />
                                    </HorizontalStackLayout>

                                    <!-- Separator -->
                                    <BoxView Grid.ColumnSpan="5" HeightRequest="1" Color="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource BorderColor}}" Margin="0,12,0,0" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>