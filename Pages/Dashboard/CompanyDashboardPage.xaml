<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Headquartz.Pages.Dashboard.CompanyDashboardPage"
             Title="Company Dashboard">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Page Header -->
            <Grid ColumnDefinitions="*,Auto" VerticalOptions="Start">
                <VerticalStackLayout Grid.Column="0" Spacing="4">
                    <Label Text="Company Dashboard" 
                           FontSize="24" 
                           TextColor="{DynamicResource PrimaryTextColor}"
                           FontAttributes="Bold" />
                    <Label Text="Real-time overview of your business operations" 
                           TextColor="{DynamicResource SecondaryTextColor}"
                           FontSize="14" />
                </VerticalStackLayout>

                <!-- Simulation Status -->
                <Frame Grid.Column="1"
                       BackgroundColor="{DynamicResource SurfaceColor}"
                       Padding="12,8"
                       CornerRadius="12"
                       BorderColor="{DynamicResource BorderColor}">
                    <HorizontalStackLayout Spacing="8">
                        <BoxView Color="{Binding SimulationStatusColor}"
                                 WidthRequest="10"
                                 HeightRequest="10"
                                 VerticalOptions="Center"
                                 CornerRadius="5" />
                        <Label Text="{Binding SimulationStatus}"
                               TextColor="{DynamicResource PrimaryTextColor}"
                               FontSize="12"
                               FontAttributes="Bold" />
                    </HorizontalStackLayout>
                </Frame>
            </Grid>

            <!-- Key Performance Indicators -->
            <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="16">
                <!-- Total Products -->
                <Frame Grid.Column="0"
                       BackgroundColor="{DynamicResource CardBackgroundColor}"
                       Padding="16"
                       CornerRadius="10"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="8">
                            <Frame BackgroundColor="#E8F4FF"
                                   Padding="8"
                                   CornerRadius="8">
                                <Label Text="ðŸ“¦"
                                       FontSize="16" />
                            </Frame>
                            <Label Text="Total Products"
                                   TextColor="{DynamicResource PrimaryTextColor}"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>

                        <Label Text="{Binding TotalProducts}"
                               TextColor="{DynamicResource PrimaryTextColor}"
                               FontSize="24"
                               FontAttributes="Bold" />

                        <Grid ColumnDefinitions="*,Auto">
                            <Label Grid.Column="0"
                                   Text="Active SKUs"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                            <Label Grid.Column="1"
                                   Text="{Binding ProductsChange, StringFormat='{0:+0;-0;0}'}"
                                   TextColor="{Binding ProductsChangeColor}"
                                   FontSize="12"
                                   FontAttributes="Bold" />
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

                <!-- Monthly Revenue -->
                <Frame Grid.Column="1"
                       BackgroundColor="{DynamicResource CardBackgroundColor}"
                       Padding="16"
                       CornerRadius="10"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="8">
                            <Frame BackgroundColor="#E8F7FF"
                                   Padding="8"
                                   CornerRadius="8">
                                <Label Text="ðŸ’°"
                                       FontSize="16" />
                            </Frame>
                            <Label Text="Monthly Revenue"
                                   TextColor="{DynamicResource PrimaryTextColor}"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>

                        <Label Text="{Binding MonthlyRevenue, StringFormat='${0:N0}'}"
                               TextColor="{DynamicResource PrimaryTextColor}"
                               FontSize="24"
                               FontAttributes="Bold" />

                        <Grid ColumnDefinitions="*,Auto">
                            <Label Grid.Column="0"
                                   Text="This month"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                            <Label Grid.Column="1"
                                   Text="{Binding RevenueChange, StringFormat='{0:+$0;-$0;0}'}"
                                   TextColor="{Binding RevenueChangeColor}"
                                   FontSize="12"
                                   FontAttributes="Bold" />
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

                <!-- Active Orders -->
                <Frame Grid.Column="2"
                       BackgroundColor="{DynamicResource CardBackgroundColor}"
                       Padding="16"
                       CornerRadius="10"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="8">
                            <Frame BackgroundColor="#F0F7FF"
                                   Padding="8"
                                   CornerRadius="8">
                                <Label Text="ðŸ›’"
                                       FontSize="16" />
                            </Frame>
                            <Label Text="Active Orders"
                                   TextColor="{DynamicResource PrimaryTextColor}"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>

                        <Label Text="{Binding ActiveOrders}"
                               TextColor="{DynamicResource PrimaryTextColor}"
                               FontSize="24"
                               FontAttributes="Bold" />

                        <Grid ColumnDefinitions="*,Auto">
                            <Label Grid.Column="0"
                                   Text="In progress"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                            <Label Grid.Column="1"
                                   Text="{Binding CompletionRate, StringFormat='{0:P0}'}"
                                   TextColor="{Binding CompletionRateColor}"
                                   FontSize="12"
                                   FontAttributes="Bold" />
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

                <!-- Orders This Month -->
                <Frame Grid.Column="3"
                       BackgroundColor="{DynamicResource CardBackgroundColor}"
                       Padding="16"
                       CornerRadius="10"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="8">
                            <Frame BackgroundColor="#F5F7FA"
                                   Padding="8"
                                   CornerRadius="8">
                                <Label Text="ðŸ“ˆ"
                                       FontSize="16" />
                            </Frame>
                            <Label Text="Monthly Orders"
                                   TextColor="{DynamicResource PrimaryTextColor}"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>

                        <Label Text="{Binding OrdersThisMonth}"
                               TextColor="{DynamicResource PrimaryTextColor}"
                               FontSize="24"
                               FontAttributes="Bold" />

                        <Grid ColumnDefinitions="*,Auto">
                            <Label Grid.Column="0"
                                   Text="Total orders"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                            <Label Grid.Column="1"
                                   Text="{Binding OrdersChange, StringFormat='{0:+0;-0;0}'}"
                                   TextColor="{Binding OrdersChangeColor}"
                                   FontSize="12"
                                   FontAttributes="Bold" />
                        </Grid>
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <!-- Main Content Grid -->
            <Grid ColumnDefinitions="2*,1*" ColumnSpacing="16">
                <!-- Revenue Overview -->
                <Frame Grid.Column="0"
                       BackgroundColor="{DynamicResource CardBackgroundColor}"
                       Padding="20"
                       CornerRadius="12"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="16">
                        <!-- Header -->
                        <Grid>
                            <HorizontalStackLayout Spacing="12">
                                <Frame BackgroundColor="{DynamicResource BadgeBackgroundColor}"
                                       Padding="10"
                                       CornerRadius="10">
                                    <Label Text="ðŸ“Š"
                                           FontSize="20"
                                           TextColor="{DynamicResource BadgeTextColor}" />
                                </Frame>
                                <VerticalStackLayout Spacing="2">
                                    <Label Text="Revenue Overview"
                                           TextColor="{DynamicResource PrimaryTextColor}"
                                           FontSize="18"
                                           FontAttributes="Bold" />
                                    <Label Text="Monthly revenue and order trends"
                                           TextColor="{DynamicResource SecondaryTextColor}"
                                           FontSize="12" />
                                </VerticalStackLayout>
                            </HorizontalStackLayout>

                            <Button Text="View Details â†’"
                                    Command="{Binding ViewRevenueDetailsCommand}"
                                    HorizontalOptions="End"
                                    BackgroundColor="Transparent"
                                    TextColor="{DynamicResource TextButtonColor}"
                                    FontSize="12" />
                        </Grid>

                        <!-- Chart Area -->
                        <Frame BackgroundColor="{DynamicResource SurfaceColor}"
                               Padding="0"
                               CornerRadius="8"
                               HasShadow="False">
                            <Grid HeightRequest="250">
                                <!-- Chart Placeholder with Professional Design -->
                                <Grid RowDefinitions="Auto,*,Auto" Padding="40,20,40,10">
                                    <!-- Y-Axis Labels -->
                                    <VerticalStackLayout Grid.Row="1" Spacing="0" WidthRequest="40">
                                        <Label Text="$300K" TextColor="{DynamicResource SecondaryTextColor}" FontSize="10" HorizontalOptions="End" />
                                        <Label Text="$200K" TextColor="{DynamicResource SecondaryTextColor}" FontSize="10" HorizontalOptions="End" />
                                        <Label Text="$100K" TextColor="{DynamicResource SecondaryTextColor}" FontSize="10" HorizontalOptions="End" />
                                        <Label Text="$0" TextColor="{DynamicResource SecondaryTextColor}" FontSize="10" HorizontalOptions="End" />
                                    </VerticalStackLayout>

                                    <!-- Bars -->
                                    <HorizontalStackLayout Grid.Row="1" Grid.Column="0" 
                                                           Spacing="20" Padding="40,0,0,0"
                                                           HorizontalOptions="Center" VerticalOptions="End">
                                        <VerticalStackLayout Spacing="2">
                                            <BoxView Color="{DynamicResource PrimaryColor}" 
                                                     WidthRequest="40" 
                                                     HeightRequest="180" 
                                                     CornerRadius="4" />
                                            <Label Text="Jan" TextColor="{DynamicResource SecondaryTextColor}" FontSize="11" HorizontalOptions="Center" />
                                        </VerticalStackLayout>
                                        <VerticalStackLayout Spacing="2">
                                            <BoxView Color="{DynamicResource PrimaryColor}" 
                                                     WidthRequest="40" 
                                                     HeightRequest="220" 
                                                     CornerRadius="4" />
                                            <Label Text="Feb" TextColor="{DynamicResource SecondaryTextColor}" FontSize="11" HorizontalOptions="Center" />
                                        </VerticalStackLayout>
                                        <VerticalStackLayout Spacing="2">
                                            <BoxView Color="{DynamicResource PrimaryColor}" 
                                                     WidthRequest="40" 
                                                     HeightRequest="200" 
                                                     CornerRadius="4" />
                                            <Label Text="Mar" TextColor="{DynamicResource SecondaryTextColor}" FontSize="11" HorizontalOptions="Center" />
                                        </VerticalStackLayout>
                                        <VerticalStackLayout Spacing="2">
                                            <BoxView Color="{DynamicResource PrimaryColor}" 
                                                     WidthRequest="40" 
                                                     HeightRequest="250" 
                                                     CornerRadius="4" />
                                            <Label Text="Apr" TextColor="{DynamicResource SecondaryTextColor}" FontSize="11" HorizontalOptions="Center" />
                                        </VerticalStackLayout>
                                        <VerticalStackLayout Spacing="2">
                                            <BoxView Color="{DynamicResource PrimaryColor}" 
                                                     WidthRequest="40" 
                                                     HeightRequest="240" 
                                                     CornerRadius="4" />
                                            <Label Text="May" TextColor="{DynamicResource SecondaryTextColor}" FontSize="11" HorizontalOptions="Center" />
                                        </VerticalStackLayout>
                                        <VerticalStackLayout Spacing="2">
                                            <BoxView Color="{DynamicResource PrimaryColor}" 
                                                     WidthRequest="40" 
                                                     HeightRequest="270" 
                                                     CornerRadius="4" />
                                            <Label Text="Jun" TextColor="{DynamicResource SecondaryTextColor}" FontSize="11" HorizontalOptions="Center" />
                                        </VerticalStackLayout>
                                    </HorizontalStackLayout>
                                </Grid>
                            </Grid>
                        </Frame>

                        <!-- Chart Legend -->
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="20">
                            <HorizontalStackLayout Grid.Column="0" Spacing="8">
                                <BoxView Color="{DynamicResource PrimaryColor}" 
                                         WidthRequest="12" 
                                         HeightRequest="12" 
                                         CornerRadius="2"
                                         VerticalOptions="Center" />
                                <Label Text="Revenue" 
                                       TextColor="{DynamicResource SecondaryTextColor}"
                                       FontSize="12" />
                            </HorizontalStackLayout>
                            <Label Grid.Column="1"
                                   Text="6-month trend"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   FontSize="12"
                                   HorizontalOptions="End" />
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

                <!-- Recent Activity -->
                <Frame Grid.Column="1"
                       BackgroundColor="{DynamicResource CardBackgroundColor}"
                       Padding="20"
                       CornerRadius="12"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="16">
                        <!-- Header -->
                        <Grid>
                            <HorizontalStackLayout Spacing="12">
                                <Frame BackgroundColor="{DynamicResource BadgeBackgroundColor}"
                                       Padding="10"
                                       CornerRadius="10">
                                    <Label Text="ðŸ””"
                                           FontSize="20"
                                           TextColor="{DynamicResource BadgeTextColor}" />
                                </Frame>
                                <VerticalStackLayout Spacing="2">
                                    <Label Text="Recent Activity"
                                           TextColor="{DynamicResource PrimaryTextColor}"
                                           FontSize="18"
                                           FontAttributes="Bold" />
                                    <Label Text="Latest system events"
                                           TextColor="{DynamicResource SecondaryTextColor}"
                                           FontSize="12" />
                                </VerticalStackLayout>
                            </HorizontalStackLayout>

                            <Button Text="View All â†’"
                                    Command="{Binding ViewAllActivitiesCommand}"
                                    HorizontalOptions="End"
                                    BackgroundColor="Transparent"
                                    TextColor="{DynamicResource TextButtonColor}"
                                    FontSize="12" />
                        </Grid>

                        <!-- Activities List -->
                        <CollectionView ItemsSource="{Binding RecentActivities}" 
                                        HeightRequest="250">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="12,8"
                                            BackgroundColor="Transparent">
                                        <Grid ColumnDefinitions="Auto,*,Auto" 
                                              ColumnSpacing="12"
                                              RowSpacing="4">
                                            <!-- Icon -->
                                            <Frame Grid.Column="0"
                                                   BackgroundColor="{Binding IconBackgroundColor}"
                                                   Padding="8"
                                                   CornerRadius="8">
                                                <Label Text="{Binding Icon}"
                                                       FontSize="14"
                                                       TextColor="{Binding IconColor}"
                                                       HorizontalOptions="Center"
                                                       VerticalOptions="Center" />
                                            </Frame>

                                            <!-- Details -->
                                            <VerticalStackLayout Grid.Column="1" Spacing="2">
                                                <Label Text="{Binding Description}"
                                                       TextColor="{DynamicResource PrimaryTextColor}"
                                                       FontSize="13"
                                                       LineBreakMode="WordWrap" />
                                                <Label Text="{Binding TimeAgo}"
                                                       TextColor="{DynamicResource SecondaryTextColor}"
                                                       FontSize="11" />
                                            </VerticalStackLayout>

                                            <!-- Action Indicator -->
                                            <BoxView Grid.Column="2"
                                                     Color="{Binding ActionColor}"
                                                     WidthRequest="6"
                                                     HeightRequest="6"
                                                     VerticalOptions="Center"
                                                     HorizontalOptions="End"
                                                     CornerRadius="3" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>

                        <!-- No Activities Placeholder -->
                        <Frame IsVisible="{Binding HasNoActivities}"
                               BackgroundColor="{DynamicResource SurfaceColor}"
                               Padding="40,20"
                               CornerRadius="8"
                               HorizontalOptions="Fill"
                               HasShadow="False">
                            <VerticalStackLayout Spacing="12" HorizontalOptions="Center">
                                <Label Text="ðŸ“­"
                                       FontSize="32"
                                       HorizontalOptions="Center" />
                                <Label Text="No recent activity"
                                       TextColor="{DynamicResource SecondaryTextColor}"
                                       FontSize="14"
                                       HorizontalOptions="Center" />
                            </VerticalStackLayout>
                        </Frame>
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <!-- Simulation Controls -->
            <Frame BackgroundColor="{DynamicResource CardBackgroundColor}"
                   Padding="20"
                   CornerRadius="12"
                   HasShadow="True">
                <Grid ColumnDefinitions="*,Auto" ColumnSpacing="20">
                    <!-- Simulation Info -->
                    <VerticalStackLayout Grid.Column="0" Spacing="12">
                        <Label Text="Simulation Controls"
                               TextColor="{DynamicResource PrimaryTextColor}"
                               FontSize="18"
                               FontAttributes="Bold" />

                        <Grid ColumnDefinitions="Auto,*,Auto" VerticalOptions="Center">
                            <Label Grid.Column="0"
                                   Text="â±ï¸"
                                   FontSize="20"
                                   VerticalOptions="Center" />
                            <VerticalStackLayout Grid.Column="1" Spacing="2" Margin="12,0">
                                <Label Text="{Binding GameTimeString}"
                                       TextColor="{DynamicResource PrimaryTextColor}"
                                       FontSize="24"
                                       FontAttributes="Bold" />
                                <Label Text="Simulation time elapsed"
                                       TextColor="{DynamicResource SecondaryTextColor}"
                                       FontSize="12" />
                            </VerticalStackLayout>
                            <Frame Grid.Column="2"
                                   BackgroundColor="{Binding SimulationSpeedColor}"
                                   Padding="8,4"
                                   CornerRadius="8">
                                <Label Text="{Binding SimulationSpeed, StringFormat='{0}x speed'}"
                                       TextColor="{DynamicResource PrimaryButtonTextColor}"
                                       FontSize="12"
                                       FontAttributes="Bold" />
                            </Frame>
                        </Grid>
                    </VerticalStackLayout>

                    <!-- Control Buttons -->
                    <HorizontalStackLayout Grid.Column="1" Spacing="12" HorizontalOptions="End">
                        <Button Text="â¸ Pause"
                                Command="{Binding StopCommand}"
                                BackgroundColor="{DynamicResource WarningColor}"
                                TextColor="White"
                                CornerRadius="8"
                                Padding="24,12"
                                FontSize="14"
                                FontAttributes="Bold" />
                        <Button Text="â–¶ Resume"
                                Command="{Binding StartCommand}"
                                BackgroundColor="{DynamicResource PrimaryButtonBackground}"
                                TextColor="{DynamicResource PrimaryButtonTextColor}"
                                CornerRadius="8"
                                Padding="24,12"
                                FontSize="14"
                                FontAttributes="Bold" />
                        <Button Text="â© Fast Forward"
                                Command="{Binding FastForwardCommand}"
                                BackgroundColor="{DynamicResource InfoColor}"
                                TextColor="White"
                                CornerRadius="8"
                                Padding="24,12"
                                FontSize="14" />
                    </HorizontalStackLayout>
                </Grid>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>